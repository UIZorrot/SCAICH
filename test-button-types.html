<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Button Types Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .button-demo {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            align-items: center;
        }
        .fulltext-btn {
            background: #52c41a;
            color: white;
            border: 1px solid #52c41a;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .fulltext-btn:hover {
            background: #389e0d;
            border-color: #389e0d;
        }
        .source-btn {
            background: transparent;
            color: #000;
            border: 1px solid #000;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .source-btn:hover {
            background: rgba(0,0,0,0.05);
        }
        .scinet-btn {
            background: #52c41a;
            color: white;
            border: 1px solid #52c41a;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .title-demo {
            color: #1890ff;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            margin: 10px 0;
        }
        .title-demo:hover {
            text-decoration: underline;
        }
        .behavior-info {
            background: #f0f8ff;
            border: 1px solid #b3d9ff;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
            font-size: 14px;
        }
        .icon {
            width: 14px;
            height: 14px;
            fill: currentColor;
        }
        .result-display {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
            min-height: 50px;
        }
    </style>
</head>
<body>
    <h1>Button Types & Behaviors Test</h1>
    <p>Testing the different button types and their behaviors according to the new specification.</p>

    <div class="test-section">
        <h3>1. "View Fulltext" Button</h3>
        <div class="behavior-info">
            <strong>Behavior:</strong> Smart API logic - try proxy first, fallback to DOI<br>
            <strong>Style:</strong> Green primary button<br>
            <strong>Trigger:</strong> Only for papers with available fulltext
        </div>
        <div class="button-demo">
            <button class="fulltext-btn" onclick="testViewFulltext()">
                ğŸ“„ View Fulltext
            </button>
            <span>â† Green, uses smart API logic</span>
        </div>
        <div id="fulltext-result" class="result-display">
            Click the button to test View Fulltext behavior...
        </div>
    </div>

    <div class="test-section">
        <h3>2. "View Source" Button</h3>
        <div class="behavior-info">
            <strong>Behavior:</strong> Direct DOI mode - always opens DOI page<br>
            <strong>Style:</strong> Black outlined button<br>
            <strong>Trigger:</strong> For papers without direct fulltext access
        </div>
        <div class="button-demo">
            <button class="source-btn" onclick="testViewSource()">
                ğŸ“„ View Source
            </button>
            <span>â† Black outlined, direct DOI mode</span>
        </div>
        <div id="source-result" class="result-display">
            Click the button to test View Source behavior...
        </div>
    </div>

    <div class="test-section">
        <h3>3. "Fulltext Sci-Net" Button</h3>
        <div class="behavior-info">
            <strong>Behavior:</strong> Direct Sci-Net link<br>
            <strong>Style:</strong> Green primary button<br>
            <strong>Trigger:</strong> For papers available on Sci-Net
        </div>
        <div class="button-demo">
            <button class="scinet-btn" onclick="testSciNet()">
                ğŸ“„ Fulltext Sci-Net
            </button>
            <span>â† Green, direct Sci-Net link</span>
        </div>
        <div id="scinet-result" class="result-display">
            Click the button to test Sci-Net behavior...
        </div>
    </div>

    <div class="test-section">
        <h3>4. Title Click Behavior</h3>
        <div class="behavior-info">
            <strong>Behavior:</strong> All titles use DOI mode<br>
            <strong>Style:</strong> Blue clickable text<br>
            <strong>Trigger:</strong> Any paper title click
        </div>
        <div class="title-demo" onclick="testTitleClick()">
            Example Paper Title: A Study on Something Important
        </div>
        <div id="title-result" class="result-display">
            Click the title to test title click behavior...
        </div>
    </div>

    <div class="test-section">
        <h3>5. PDF Display Test</h3>
        <div class="behavior-info">
            <strong>Issue:</strong> PDF currently downloads instead of displaying in browser<br>
            <strong>Solution:</strong> Use proper link creation without download attribute
        </div>
        <div class="button-demo">
            <button class="fulltext-btn" onclick="testPdfDisplay()">
                ğŸ“„ Test PDF Display
            </button>
            <span>â† Should open PDF in browser, not download</span>
        </div>
        <div id="pdf-result" class="result-display">
            Click to test PDF display behavior...
        </div>
    </div>

    <script>
        const testDoi = '10.1136/heartjnl-2017-311198';

        // æ¨¡æ‹Ÿæ™ºèƒ½å…¨æ–‡æ‰“å¼€é€»è¾‘
        async function testViewFulltext() {
            const resultDiv = document.getElementById('fulltext-result');
            resultDiv.innerHTML = 'ğŸ”„ Testing View Fulltext (Smart API logic)...';
            
            const cleanDoi = testDoi.replace(/^https?:\/\/doi\.org\//i, "");
            const encodedDoi = encodeURIComponent(cleanDoi);
            const proxyUrl = `https://api.scai.sh/api/fulltext/proxy/${encodedDoi}`;
            const doiUrl = `https://doi.org/${cleanDoi}`;
            
            try {
                // æ¨¡æ‹Ÿä»£ç†æ£€æŸ¥
                resultDiv.innerHTML += '<br>ğŸ“¡ Checking proxy availability...';
                
                // ç®€åŒ–çš„æ£€æŸ¥ï¼ˆå®é™…åº”ç”¨ä¸­ä¼šæ›´å¤æ‚ï¼‰
                const isAvailable = Math.random() > 0.5; // éšæœºæ¨¡æ‹Ÿ
                
                if (isAvailable) {
                    resultDiv.innerHTML += '<br>âœ… Proxy available, opening proxy URL';
                    resultDiv.innerHTML += `<br>ğŸ”— Opening: ${proxyUrl}`;
                    // å®é™…ä¼šæ‰“å¼€é“¾æ¥
                    // window.open(proxyUrl, '_blank');
                } else {
                    resultDiv.innerHTML += '<br>âŒ Proxy not available, falling back to DOI';
                    resultDiv.innerHTML += `<br>ğŸ”— Opening: ${doiUrl}`;
                    // window.open(doiUrl, '_blank');
                }
            } catch (error) {
                resultDiv.innerHTML += `<br>âŒ Error: ${error.message}`;
            }
        }

        // æ¨¡æ‹ŸView Sourceè¡Œä¸º
        function testViewSource() {
            const resultDiv = document.getElementById('source-result');
            const cleanDoi = testDoi.replace(/^https?:\/\/doi\.org\//i, "");
            const doiUrl = `https://doi.org/${cleanDoi}`;
            
            resultDiv.innerHTML = 'ğŸ“„ View Source: Direct DOI mode';
            resultDiv.innerHTML += `<br>ğŸ”— Opening: ${doiUrl}`;
            resultDiv.innerHTML += '<br>â„¹ï¸ No API check, direct to publisher page';
            
            // å®é™…ä¼šæ‰“å¼€DOIé“¾æ¥
            // window.open(doiUrl, '_blank');
        }

        // æ¨¡æ‹ŸSci-Netè¡Œä¸º
        function testSciNet() {
            const resultDiv = document.getElementById('scinet-result');
            const cleanDoi = testDoi.replace(/^https?:\/\/doi\.org\//i, "");
            const scinetUrl = `https://sci-net.xyz/${cleanDoi}`;
            
            resultDiv.innerHTML = 'ğŸŒ Sci-Net: Direct link';
            resultDiv.innerHTML += `<br>ğŸ”— Opening: ${scinetUrl}`;
            
            // å®é™…ä¼šæ‰“å¼€Sci-Neté“¾æ¥
            // window.open(scinetUrl, '_blank');
        }

        // æ¨¡æ‹Ÿæ ‡é¢˜ç‚¹å‡»è¡Œä¸º
        function testTitleClick() {
            const resultDiv = document.getElementById('title-result');
            const cleanDoi = testDoi.replace(/^https?:\/\/doi\.org\//i, "");
            const doiUrl = `https://doi.org/${cleanDoi}`;
            
            resultDiv.innerHTML = 'ğŸ“‹ Title Click: DOI mode';
            resultDiv.innerHTML += `<br>ğŸ”— Opening: ${doiUrl}`;
            resultDiv.innerHTML += '<br>â„¹ï¸ All titles use DOI mode regardless of paper type';
            
            // å®é™…ä¼šæ‰“å¼€DOIé“¾æ¥
            // window.open(doiUrl, '_blank');
        }

        // æµ‹è¯•PDFæ˜¾ç¤º
        function testPdfDisplay() {
            const resultDiv = document.getElementById('pdf-result');
            const cleanDoi = testDoi.replace(/^https?:\/\/doi\.org\//i, "");
            const encodedDoi = encodeURIComponent(cleanDoi);
            const proxyUrl = `https://api.scai.sh/api/fulltext/proxy/${encodedDoi}`;
            
            resultDiv.innerHTML = 'ğŸ“„ Testing PDF display method...';
            resultDiv.innerHTML += `<br>ğŸ”— URL: ${proxyUrl}`;
            resultDiv.innerHTML += '<br>ğŸ“‹ Method: Create link element without download attribute';
            
            // æ¨¡æ‹Ÿæ­£ç¡®çš„PDFæ‰“å¼€æ–¹å¼
            const link = document.createElement('a');
            link.href = proxyUrl;
            link.target = '_blank';
            link.rel = 'noopener noreferrer';
            // ä¸è®¾ç½®downloadå±æ€§
            
            resultDiv.innerHTML += '<br>âœ… Link created, would open in browser (not download)';
            
            // å®é™…ä½¿ç”¨æ—¶ä¼šæ‰§è¡Œï¼š
            // document.body.appendChild(link);
            // link.click();
            // document.body.removeChild(link);
        }
    </script>
</body>
</html>
